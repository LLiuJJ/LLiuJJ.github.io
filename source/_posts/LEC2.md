---
title: LEC2
date: 2019-01-17 12:50:09
tags: 分布式系统6.824笔记
---

#### 基础设施: RPC 和 线程

**一个最常被问到的问题:为什么使用Go**

***6.824这门课原先是使用C++的***

学生花了很多时间去修与构建分布式系统无关的bug

例如C++编程里面一个创建对象的问题，学生free了还需要使用的对象

***Go 语言可以让你更专注的处理分布式系统的问题***

1.Go语言是类型安全的

2.它有垃圾收集器（不会存在对象没有free导致的程序bug）

3.对并发编程的支持很友好

4.对RPC的支持很友好

***我们喜欢用Go编程***

1.Go很容易学习

2.Go语言推荐资料 https://golang.org/doc/effective_go.html#generality

**远程过程调用 (RPC)**

1.分布式系统中的关键部分，所有的lab都使用到了RPC，它使得网络交互的程序更容易编写

2.隐藏了客户端/服务器通信的大部分细节

3.通过RPC客户端的远程调用就像普通的过程调用

4.服务器的处理程序和普通的程序类似

5.RPC被广泛使用

**理想情况下，RPC使得网络通信看起来就像函数的调用**

客户端：

```
z = fn(x, y)
```

服务器：

```
fn(x, y) {
    compute
    return z
}
```

RPC旨在实现这种透明度的调用

Go语言RPC的库 https://golang.org/pkg/net/rpc/

**RPC 消息图**

Client				Server

request --->

​			<--- response

**软件架构**

客户端应用存根			处理调用

RPC 库					RPC库

Net   ——————————   Net

**更多的细节**

1.要调用服务器的那个处理函数

2.Marshalling（编组）：将数据格式化为数据包

​	处理数组、指针和对象是很棘手的

​	Go的RPC库是相当强大的

​	有一些东西你不能传送：例如，channels（通道）,functions（函数）

3.Binding（绑定）:客户端如何知道与谁交互?

​       客户端被提供了服务器的主机名

​       也许名称服务将服务映射到最佳的服务器主机

4.线程：

​	客户端可能启动很多线程，所以1个以上的调用未完成，匹配响应

​	处理程序可能很慢，因此服务器经常在每一个线程中运行每个处理程序

**RPC问题：如何处理失败**

​	例如：数据包丢失、网络中断、服务器速度慢、服务器崩溃

**客户端RPC库中的故障是什么样的?**

​	客户端从未收到服务器的响应

​	客户端不知道服务器是否能看到请求

​	可能服务器或者网络在发送回复之前失败了

