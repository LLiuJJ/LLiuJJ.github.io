---
title: LEC4
date: 2019-02-07 08:52:12
tags:
---

**今天的主题**

1.主/从复制

- 广泛使用，例如GFS的区块服务器
- 但是今天被广泛应用于强一致
- 特别重要，我们需要深入探索它

2.VM-FT案例的学习

**容错性**

1.我们需要构建一个即使失败也能继续的服务

2.高可用：在一些失败后仍然可用

3.强一致：对与客户端来说就像只有一个服一样，比GFS文件服务更加健壮。

4.非常困难！

5.非常有用！

**需要一个服务失败模型：我们将尝试处理什么？**

1.独立的故障，停止计算机的故障

- VM-FT假设一次只出现一个故障

2.停电（最终重启）

3.网络分区

4.没有bugs，没有恶意攻击

**核心的想法：复制**

1.两台服务器

2.每个副本保持着服务所需要的状态

3.如果一个副本失效了，其他的可以继续提供服务

**例子：MapReduce里面的matser模型**

1.lab1里面的worker是高可用的，但是没有master

- master是单点故障的

2.我们可以有两个master吗，在一个失败的情况下？

[架构图：M1, M2, workers]

状态：

- worker列表
- 那些job做完了
- 那些worker空闲
- TCP连接的状态
- 程序计数器

**大的问题**

1.要复制的状态是什么？

2.副本如何获得状态？

3.何时切换到副本服务器？

4.切换的时候是否会表现出异常状态？

5.如何修复，重新集成？

**两个主要的方法**

1.状态转换

- 主服务器执行服务
- 主服务器项备服务器发送新的状态

2.副本的状态机

- 所有的副本执行所有的操作
- 如果所有副本有相同的开始状态，相同的操作，相同的操作顺序，确定的方法，会的到最终相同的状态

**状态转换更简单**

1.但是状态空间可能比较大，转换起来很慢

2.VM-FT使用复制状态机

